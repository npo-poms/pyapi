#!/usr/bin/env python3
"""
  Simple client to post an object from the NPO Backend API
"""
from npoapi import MediaBackend
from xml.dom.minidom import parse, parseString

client = MediaBackend().command_line_client(description="Set an media object from the NPO Backend API")
client.add_argument('xml', type=str, nargs=1, help='The xml to post')
client.add_argument('-S', '--search', action='store_true',
                    help="""The xml is interpreted as a search""")


args = client.parse_args()
search = args.search

if search:
    print(client.find(args.xml[0]))
else:
    xml=parseString(client.data_or_from_file(args.xml[0]))
    if xml.childNodes[0].nodeName == "NPO_gfxwrp":
        print(client.parkpost(xml))
    else:
        print(client.post(xml))
client.exit()

